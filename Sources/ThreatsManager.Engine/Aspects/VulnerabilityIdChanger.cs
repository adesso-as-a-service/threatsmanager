using PostSharp.Aspects;
using PostSharp.Aspects.Advices;
using PostSharp.Serialization;
using System;

namespace ThreatsManager.Engine.Aspects
{
    [PSerializable]
    [IntroduceInterface(typeof(IVulnerabilityIdChanger))]
    internal class VulnerabilityIdChangerAttribute : InstanceLevelAspect, IVulnerabilityIdChanger
    {
        #region Extra elements to be added.
        [ImportMember(nameof(_vulnerabilityId))]
        public Property<Guid> _vulnerabilityId;
        #endregion

        public Guid GetVulnerabilityId()
        {
            return _vulnerabilityId?.Get() ?? Guid.Empty;
        }

        public void SetVulnerabilityId(Guid newId)
        {
            _vulnerabilityId?.Set(newId);
        }
    }
}
